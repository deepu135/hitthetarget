<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
  <title>Slingshot Game</title>
  <style>
    html, body {
      margin: 0;
      padding: 0;
      overflow: hidden;
      background: #87CEEB;
      font-family: Arial, sans-serif;
      height: 100%;
      width: 100%;
      touch-action: none;
    }

    canvas {
      display: block;
      position: absolute;
      top: 0;
      left: 0;
      touch-action: none;
    }

    #rotateMessage {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      background: rgba(0, 0, 0, 0.85);
      color: white;
      font-size: 22px;
      display: none;
      justify-content: center;
      align-items: center;
      text-align: center;
      padding: 20px;
      z-index: 1000;
    }
  </style>
</head>
<body>
  <div id="rotateMessage">Please rotate your device to landscape mode to play the game.</div>
  <canvas id="gameCanvas"></canvas>

  <script>
    const canvas = document.getElementById("gameCanvas");
    const ctx = canvas.getContext("2d");
    const rotateMessage = document.getElementById("rotateMessage");

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }

    function checkOrientation() {
      const isMobile = /Mobi|Android/i.test(navigator.userAgent);
      const isPortrait = window.innerHeight > window.innerWidth;

      if (isMobile && isPortrait) {
        rotateMessage.style.display = "flex";
        canvas.style.display = "none";
      } else {
        rotateMessage.style.display = "none";
        canvas.style.display = "block";
        resizeCanvas();
      }
    }

    window.addEventListener("resize", checkOrientation);
    window.addEventListener("orientationchange", checkOrientation);

    const ball = {
      x: 150,
      y: 150,
      r: 30,
      vx: 0,
      vy: 0,
      isDragging: false,
      launched: false
    };

    const targetBall = {
      x: 800,
      y: 200,
      r: 25,
      vy: 0,
      falling: false
    };

    const boxes = [
      { x: 780, y: 300, w: 40, h: 80 },
      { x: 780, y: 220, w: 40, h: 80 },
      { x: 780, y: 140, w: 40, h: 80 }
    ];

    const gravity = 0.5;
    const friction = 0.98;
    const ground = 100;

    function drawGround() {
      ctx.fillStyle = "#228B22";
      ctx.fillRect(0, canvas.height - ground, canvas.width, ground);
    }

    function drawBall(ballObj, color = "brown") {
      ctx.beginPath();
      ctx.arc(ballObj.x, ballObj.y, ballObj.r, 0, Math.PI * 2);
      ctx.fillStyle = color;
      ctx.fill();
    }

    function drawBoxes() {
      ctx.fillStyle = "#666";
      boxes.forEach(box => {
        ctx.fillRect(box.x, box.y, box.w, box.h);
      });
    }

    function updateTargetBall() {
      if (targetBall.falling) {
        targetBall.vy += gravity;
        targetBall.y += targetBall.vy;

        if (targetBall.y + targetBall.r > canvas.height - ground) {
          targetBall.y = canvas.height - ground - targetBall.r;
          targetBall.vy = 0;
        }
      }
    }

    function updateBall() {
      if (ball.launched) {
        ball.vy += gravity;
        ball.x += ball.vx;
        ball.y += ball.vy;

        ball.vx *= friction;
        ball.vy *= friction;

        if (ball.y + ball.r > canvas.height - ground) {
          ball.y = canvas.height - ground - ball.r;
          ball.vy *= -0.6;
        }
      }
    }

    function checkCollision() {
      const dx = ball.x - targetBall.x;
      const dy = ball.y - targetBall.y;
      const distance = Math.sqrt(dx * dx + dy * dy);

      if (distance < ball.r + targetBall.r) {
        targetBall.falling = true;
      }
    }

    function drawSlingshotLine() {
      if (ball.isDragging) {
        ctx.beginPath();
        ctx.moveTo(150, 150);
        ctx.lineTo(ball.x, ball.y);
        ctx.strokeStyle = "black";
        ctx.lineWidth = 2;
        ctx.stroke();
      }
    }

    function animate() {
      ctx.clearRect(0, 0, canvas.width, canvas.height);
      drawGround();
      drawBoxes();
      drawBall(ball);
      drawBall(targetBall, "red");
      drawSlingshotLine();
      updateBall();
      updateTargetBall();
      if (ball.launched) checkCollision();
      requestAnimationFrame(animate);
    }

    function getCanvasCoords(clientX, clientY) {
      const rect = canvas.getBoundingClientRect();
      return {
        x: (clientX - rect.left) * (canvas.width / rect.width),
        y: (clientY - rect.top) * (canvas.height / rect.height)
      };
    }

    canvas.addEventListener("mousedown", e => {
      const { x, y } = getCanvasCoords(e.clientX, e.clientY);
      const dx = x - ball.x;
      const dy = y - ball.y;
      if (Math.sqrt(dx * dx + dy * dy) < ball.r) {
        ball.isDragging = true;
      }
    });

    canvas.addEventListener("mousemove", e => {
      if (ball.isDragging) {
        const { x, y } = getCanvasCoords(e.clientX, e.clientY);
        ball.x = x;
        ball.y = y;
      }
    });

    canvas.addEventListener("mouseup", e => {
      if (ball.isDragging) {
        const { x, y } = getCanvasCoords(e.clientX, e.clientY);
        ball.isDragging = false;
        ball.launched = true;
        ball.vx = (150 - x) * 0.2;
        ball.vy = (150 - y) * 0.2;
      }
    });

    canvas.addEventListener("touchstart", e => {
      const touch = e.touches[0];
      const { x, y } = getCanvasCoords(touch.clientX, touch.clientY);
      const dx = x - ball.x;
      const dy = y - ball.y;
      if (Math.sqrt(dx * dx + dy * dy) < ball.r) {
        ball.isDragging = true;
      }
    });

    canvas.addEventListener("touchmove", e => {
      if (ball.isDragging) {
        const touch = e.touches[0];
        const { x, y } = getCanvasCoords(touch.clientX, touch.clientY);
        ball.x = x;
        ball.y = y;
      }
    });

    canvas.addEventListener("touchend", e => {
      if (ball.isDragging) {
        const touch = e.changedTouches[0];
        const { x, y } = getCanvasCoords(touch.clientX, touch.clientY);
        ball.isDragging = false;
        ball.launched = true;
        ball.vx = (150 - x) * 0.2;
        ball.vy = (150 - y) * 0.2;
      }
    });

    window.addEventListener("load", () => {
      checkOrientation();
      resizeCanvas();
      animate();
    });
  </script>
</body>
</html>
